(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{39:function(t,e,n){},59:function(t,e,n){},69:function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),s=n(33),c=n.n(s),r=(n(39),n(10)),i=n(11),u=n(13),l=n(12),h=(n(40),n(15)),j=n.n(h),d=n(24),b=(n.p,n(59),n(8)),f=n(0),O=function(t){var e=t.author;return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{className:"col",children:Object(f.jsxs)(b.b,{to:"author/".concat(e.id),children:[" ",e.first_name," "]})}),Object(f.jsx)("td",{className:"col",children:e.last_name}),Object(f.jsx)("td",{className:"col",children:e.birthday_year})]})},m=function(t){var e=t.authors;return Object(f.jsxs)("table",{className:"container",children:[Object(f.jsx)("th",{className:"col",children:"First name"}),Object(f.jsx)("th",{className:"col",children:"Last name"}),Object(f.jsx)("th",{className:"col",children:"Birthday year"}),e.map((function(t){return Object(f.jsx)(O,{author:t})}))]})},x=function(t){var e=t.book,n=t.authors,a=t.deleteBook;return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{className:"col",children:e.id}),Object(f.jsx)("td",{className:"col",children:e.name}),Object(f.jsx)("td",{className:"col",children:e.author.map((function(t){var e=n.find((function(e){return e.id==t}));if(e)return e.last_name}))}),Object(f.jsx)("td",{children:Object(f.jsx)("button",{onClick:function(){return a(e.id)},type:"button",children:"Delete"})})]})},p=function(t){var e=t.books,n=t.authors,a=t.deleteBook;return Object(f.jsxs)("div",{children:[Object(f.jsxs)("table",{className:"container",children:[Object(f.jsx)("th",{className:"col",children:"Id"}),Object(f.jsx)("th",{className:"col",children:"Name"}),Object(f.jsx)("th",{className:"col",children:"Author"}),Object(f.jsx)("th",{className:"col",children:"Delete"}),e.map((function(t){return Object(f.jsx)(x,{book:t,authors:n,deleteBook:a})}))]}),Object(f.jsx)(b.b,{to:"/books/create",children:"Create"})]})},k=n(19),v=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={name:"",author:[]},a}return Object(i.a)(n,[{key:"handleChange",value:function(t){this.setState(Object(k.a)({},t.target.name,t.target.value))}},{key:"handleAuthorChange",value:function(t){if(t.target.selectedOptions){for(var e=[],n=0;n<t.target.selectedOptions.length;n++)e.push(t.target.selectedOptions.item(n).value);this.setState({author:e})}else this.setState({author:[]})}},{key:"handleSubmit",value:function(t){this.props.createBook(this.state.name,this.state.author),t.preventDefault()}},{key:"render",value:function(){var t=this;return Object(f.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{htmlFor:"login",children:"name"}),Object(f.jsx)("input",{type:"text",name:"name",value:this.state.name,onChange:function(e){return t.handleChange(e)}})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{htmlFor:"author",children:"author"}),Object(f.jsx)("select",{name:"author",multiple:!0,onChange:function(e){return t.handleAuthorChange(e)},children:this.props.authors.map((function(t){return Object(f.jsx)("option",{value:t.id,children:t.first_name})}))})]}),Object(f.jsx)("input",{type:"submit",value:"Save"})]})}}]),n}(o.a.Component),g=function(t){var e=t.book,n=t.authors;return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{className:"col",children:e.id}),Object(f.jsx)("td",{className:"col",children:e.name}),Object(f.jsx)("td",{className:"col",children:e.author.map((function(t){var e=n.find((function(e){return e.id==t}));if(e)return e.last_name}))})]})},_=n(2),y=function(t){var e=t.books,n=t.authors,a=Object(_.g)().id;console.log({id:a});var o=e.filter((function(t){return t.author.includes(parseInt(a))}));return console.log(o),Object(f.jsxs)("table",{className:"container",children:[Object(f.jsx)("th",{className:"col",children:"Id"}),Object(f.jsx)("th",{className:"col",children:"Name"}),Object(f.jsx)("th",{className:"col",children:"Author"}),o.map((function(t){return Object(f.jsx)(g,{book:t,authors:n})}))]})},N=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={login:"",password:""},a}return Object(i.a)(n,[{key:"handleChange",value:function(t){this.setState(Object(k.a)({},t.target.name,t.target.value)),console.log([t.target.name],t.target.value)}},{key:"handleSubmit",value:function(t){this.props.get_token(this.state.login,this.state.password),t.preventDefault()}},{key:"render",value:function(){var t=this;return Object(f.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(f.jsx)("input",{type:"text",name:"login",placeholder:"login",value:this.state.login,onChange:function(e){return t.handleChange(e)}}),Object(f.jsx)("input",{type:"password",name:"password",placeholder:"password",value:this.state.password,onChange:function(e){return t.handleChange(e)}}),Object(f.jsx)("input",{type:"submit",value:"Login"})]})}}]),n}(o.a.Component),C=function(t){var e=t.location;return Object(f.jsx)("div",{children:Object(f.jsxs)("h2",{children:[" \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 '",e.pathname,"' \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"]})})},S=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={authors:[],books:[],token:""},a}return Object(i.a)(n,[{key:"createBook",value:function(t,e){var n=this;console.log(t+" "+e);var a=this.get_headers(),o={name:t,author:e};j.a.post("http://127.0.0.1:8000/api/book/",o,{headers:a}).then((function(t){n.load_data()})).catch((function(t){console.log(t),n.setState({authors:[]})}))}},{key:"deleteBook",value:function(t){var e=this,n=this.get_headers();j.a.delete("http://127.0.0.1:8000/api/book/".concat(t),{headers:n}).then((function(t){e.load_data()})).catch((function(t){console.log(t),e.setState({authors:[]})}))}},{key:"load_data",value:function(){var t=this,e=this.get_headers();j.a.get("http://127.0.0.1:8000/api/authors/",{headers:e}).then((function(e){var n=e.data;t.setState({authors:n})})).catch((function(e){console.log(e),t.setState({authors:[]})})),j.a.get("http://127.0.0.1:8000/api/book/",{headers:e}).then((function(e){var n=e.data;t.setState({books:n})})).catch((function(e){console.log(e),t.setState({books:[]})}))}},{key:"is_auth",value:function(){return!!this.state.token}},{key:"logout",value:function(){this.set_token("")}},{key:"set_token",value:function(t){var e=this;(new d.a).set("token",t),this.setState({token:t},(function(){return e.load_data()}))}},{key:"get_token",value:function(t,e){var n=this;j.a.post("http://127.0.0.1:8000/api-token-auth/",{username:t,password:e}).then((function(t){n.set_token(t.data.token)})).catch((function(t){return alert("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c")}))}},{key:"get_headers",value:function(){var t={"Content-Type":"application/json"};return this.is_auth()&&(t.Authorization="Token "+this.state.token),t}},{key:"get_token_from_storage",value:function(){var t=this,e=(new d.a).get("token");this.setState({token:e},(function(){return t.load_data()}))}},{key:"componentDidMount",value:function(){this.get_token_from_storage()}},{key:"render",value:function(){var t=this;return Object(f.jsx)("div",{children:Object(f.jsxs)(b.a,{children:[Object(f.jsx)("nav",{children:Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:Object(f.jsx)(b.b,{to:"/",children:"Authors"})}),Object(f.jsx)("li",{children:Object(f.jsx)(b.b,{to:"/books",children:"Books"})}),Object(f.jsx)("li",{children:this.is_auth()?Object(f.jsx)("button",{onClick:function(){return t.logout()},children:" Logout"}):Object(f.jsx)(b.b,{to:"/login",children:"Login"})})]})}),Object(f.jsxs)(_.d,{children:[Object(f.jsx)(_.b,{exact:!0,path:"/",component:function(){return Object(f.jsx)(m,{authors:t.state.authors})}}),Object(f.jsx)(_.b,{exact:!0,path:"/books",component:function(){return Object(f.jsx)(p,{books:t.state.books,authors:t.state.authors,deleteBook:function(e){return t.deleteBook(e)}})}}),Object(f.jsx)(_.b,{exact:!0,path:"/books/create",component:function(){return Object(f.jsx)(v,{authors:t.state.authors,createBook:function(e,n){return t.createBook(e,n)}})}}),Object(f.jsx)(_.b,{exact:!0,path:"/login",component:function(){return Object(f.jsx)(N,{get_token:function(e,n){return t.get_token(e,n)}})}}),Object(f.jsx)(_.b,{path:"/author/:id",children:Object(f.jsx)(y,{books:this.state.books,authors:this.state.authors})}),Object(f.jsx)(_.a,{from:"/authors",to:"/"}),Object(f.jsx)(_.b,{component:C})]})]})})}}]),n}(o.a.Component),B=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,70)).then((function(e){var n=e.getCLS,a=e.getFID,o=e.getFCP,s=e.getLCP,c=e.getTTFB;n(t),a(t),o(t),s(t),c(t)}))};c.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(S,{})}),document.getElementById("root")),B()}},[[69,1,2]]]);
//# sourceMappingURL=main.2abd679e.chunk.js.map